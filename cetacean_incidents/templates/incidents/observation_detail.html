{% extends "detail.html" %}
{% load animal_extras %}
{% load contact_extras %}
{% load case_extras %}
{% load generic_field_display %}

{% block head %}
{{ block.super }}
{# location_details_include.html expects this #}
<script type="text/javascript" src="{% url site-media path="jquery/jquery-1.3.2.min.js" %}"></script>
{% endblock %}

{% block title %}{{ block.super }}: {{ observation }}{% endblock %}

{% block header %}
{% if observation.case.ole_investigation %}
{% include "incidents/ole-warning.html" %}
{% endif %}
<h2>{% case_link observation.case %}</h2>
<h2 style="margin-left:2em;">{{ observation }}</h2>
<div>
    <a href="{% block edit_url %}{% url edit_observation observation.id %}{% endblock %}">edit this observation</a>
</div>
{% endblock %}

{% block ids-dl %}
{% with observation.case.animal as a %}
{% include "incidents/animal_ids_include.html" %}
{% endwith %}
<hr>
{% block case_ids %}
{% with observation.case as c %}
{% include "incidents/case_ids_include.html" %}
{% endwith %}
{% endblock %}
<hr>
{% with observation as o %}
{% include "incidents/observation_ids_include.html" %}
{% endwith %}
{% endblock %}

{% block content %}
<table class="layout">
    <tr class="layout">
        <td class="layout" width="50%"> <!-- for making columns -->
            <div class="section">
                <h3>Observation</h3>
                <table>
                    {% display_row observation "observation_datetime" %}
                    <tr>
                        <th>observation location</th>
                        <td>
                            {% with observation.location as l %}
                            {% include "locations/location_details_include.html" %}
                            {% endwith %}
                        </td>
                    </tr>
                    <tr><th>observer</th><td>{% contact_link observation.observer %}</td></tr>
                    {% if observation.observer_vessel %}
                    <tr>
                        <th>vessel info for observer's vessel</th>
                        <td>
                            {% with observation.observer_vessel as v %}
                            {% include "vessels/vessel_details_include.html" %}
                            {% endwith %}
                        </td>
                    </tr>
                    {% endif %}
                </table>
                <h3>Reporting</h3>
                <table>
                    {% display_row observation "report_datetime" %}
                    <tr>
                        <th>reporter</th>
                        <td>
                            {% if observation.firsthand %}
                            <i>reported by the observer</i>
                            {% else %}
                            {% contact_link observation.reporter %}
                            {% endif %}
                        </td>
                    </tr>
                </table>
            </div> <!-- class="section" -->
            <div class="section">
                <h3>Animal identification</h3>
                <table>
                    {% if observation.taxon %}
                    {% display_row observation "taxon" %}
                    {% endif %}
                    {% if observation.gender %}
                    {% display_chosen_row observation "gender" %}
                    {% endif %}
                    {% display_row observation "animal_description" "description" %}
                </table>
                <table>
                    {% display_yesnounk_row observation "biopsy" %}
                    {% display_yesnounk_row observation "tagged" %}
                </table>
            </div>
            <div class="section">
                <h3>Incident details</h3>
                <table>
                    {% display_yesnounk_row observation "wounded" %}
                    {% display_bigtext_row observation "wound_description" %}
                </table>
            </div>
        </td>
        <td class="layout" width="50%">
            <div class="section">
                {% block case_type_fields %}
                <h3>CASE SPECIFIC FIELDS HERE!</h3>
                {% endblock %}
            </div>
            <div class="section">
                <h3>Narrative</h3>
                {% display_unlabeled_bigtext_div observation "narrative" %}
            </div>
            {% if observation.import_notes %}
            <div class="section">
                <h3>Import notes</h3>
                <div style="font-family: Terminus, monospace; font-size:75%;">{% display_unlabeled_bigtext_div observation "import_notes" %}</div>
            </div>
            {% endif %}
        </td>
    </tr>
</table> <!-- for making columns -->
{% endblock %}

