{% extends "page.html" %}
{% load link_filter %}

{% block head %}
{{ block.super }}
<script type="text/javascript" src="{% url site-media path="sorttable/sorttable.js" %}"></script>
<link rel="stylesheet" type="text/css" href="{% url site-media path="sorttable/sorttable.css" %}">
{% endblock %}

{% block title %}{{ block.super }}: Contact Search{% endblock %}

{% block header %}<h2>Contacts</h2>{% endblock %}

{% block content %}
<form action="" method="get">
    <div class="section">
        {% with form.non_field_errors as errors %}
        {% if errors %}
        <ul class="errorlist">
            {% for e in errors %}
            <li>{{ e }}</li>
            {% endfor %}
        </ul>
        {% endif %}
        {% endwith %}
        {% for f in form %}
        {% include "labeled_field.html" %}
        {% endfor %}
        <button type="submit">search</button>
    </div>
</form>
{% if form.is_bound %}
<div style="text-align: center;">
({{ contact_count|default:"no" }} matching contact{{ contact_count|pluralize }})
</div>
{# sorttable.js doesn't like empty tables #}
{% if contact_count > 0 %}
<table class="bordered{% if contact_list %} sortable{% endif %}">
    <thead>
        <tr>
            <th class="sorttable_nosort">link</th>
        </tr>
    </thead>
	{% for contact in contact_list %}
	<tr>
	    <td>{{ contact|link }}</td>
    </tr>
    {% empty %}
    <tr><td colspan="5" style="text-align:center;"><i>no contacts</i></td></tr>
	{% endfor %}
</table>
{% endif %}
{% else %}
<p>
    click 'search' to see a list of contacts
</p>
{% endif %}
{% endblock %}
